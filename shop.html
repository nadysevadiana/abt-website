<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Магазин для дизайнеров | Art by Twins</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <link rel="prefetch" href="header.html" as="fetch" crossorigin>
  <link rel="prefetch" href="footer.html" as="fetch" crossorigin>
  <link rel="prefetch" href="shop/legal.html" as="fetch" crossorigin>
  <link rel="prefetch" href="shop/psychology.html" as="fetch" crossorigin>
  <link rel="prefetch" href="shop/ai-tools.html" as="fetch" crossorigin>
  <!-- Icons (needed for templates with <i class="fa-...">) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

  <!-- In‑place product view: compact layout and no extra empty space -->
  <style>
    /* Make product view compact only inside #product-view */
    #product-view { padding-top: 8px; }
    #product-view .card { min-height: auto !important; display: flex; flex-direction: column; justify-content: center; }
    #product-view .card p { margin-bottom: 0; }
    #product-view .grid .card { padding: 14px; }
    #product-view .card > *:last-child { margin-bottom: 0; }

    /* Tighter sections and headings */
    #product-view section { margin-bottom: 16px; }
    #product-view h2 { margin-top: 4px; margin-bottom: 10px; }
    #product-view h3 { margin-top: 2px; margin-bottom: 10px; }

    /* Tighter grids used inside the inline product pages */
    #product-view .tight-grid .card { min-height: auto !important; padding-top: 10px; padding-bottom: 10px; }
    #product-view .tight-grid { gap: 12px; }

    /* Accordion paddings (shrink summary/content) */
    #product-view .accordion summary { padding: 14px 16px !important; }
    #product-view .accordion details > div { padding: 0 16px 14px 16px !important; }

    /* Back button stays visible and not transparent */
    #back-to-shop { background-color: #10B981; color: #fff; }
    #back-to-shop:hover { background-color: #059669; }
  </style>
</head>
<body class="site-bg text-gray-900">
  <div id="site-header"></div>

  <section class="bg-gradient-to-br from-white via-emerald-50 to-sky-50 py-12 px-6 md:px-12">
    <div class="max-w-7xl mx-auto">
      <header class="mb-4">
        <h1 class="text-3xl md:text-4xl font-bold">Магазин для дизайнеров</h1>
        <p class="mt-2 text-slate-700">Инструменты, документы и тренинги — берите ровно то, что нужно вашей задаче.</p>
      </header>

      <!-- Чипсы-фильтры -->
      <div class="flex flex-wrap gap-2 mb-8" id="shop-filters">
        <button type="button" class="chip is-active" data-filter="*">Все</button>
        <button type="button" class="chip" data-filter="3dsmax">3ds Max</button>
        <button type="button" class="chip" data-filter="sketchup">SketchUp</button>
        <button type="button" class="chip" data-filter="docs">Документы и договоры</button>
        <button type="button" class="chip" data-filter="coaching">Коучинг</button>
      </div>

      <!-- Витрина -->

      <!-- Просмотр продукта -->
      <div id="product-view" class="hidden mt-4 bg-gradient-to-br from-white to-emerald-50 rounded-xl shadow-lg border border-gray-200 p-4 pt-4 md:pt-6 relative">
        <button id="back-to-shop" class="absolute top-3 left-3 inline-flex items-center px-3 py-1.5 rounded-md bg-emerald-600 text-white hover:bg-emerald-700 text-sm shadow">
          ← Назад
        </button>
        <div id="product-content"></div>
      </div>

      <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4" id="shop-grid">

  <!-- Крупные продукты (есть отдельные страницы) -->
  <article class="card card--compact" data-cats="docs">
    <h3 class="card-title">Документы и договоры</h3>
    <p class="card-text">Готовые шаблоны документов для малого и среднего бизнеса.</p>
    <a href="#" data-product="contracts" class="btn-outline inline-flex items-center justify-center">Смотреть</a>
  </article>

  <article class="card card--compact" data-cats="3dsmax">
    <h3 class="card-title">3ds Max</h3>
    <p class="card-text">Короткие апгрейд-модули и практики для ускорения визуализации.</p>
    <a href="#" data-product="3dsmax" class="btn-outline inline-flex items-center justify-center">Смотреть</a>
  </article>

  <article class="card card--compact" data-cats="sketchup">
    <h3 class="card-title">SketchUp</h3>
    <p class="card-text">Практика по моделингу, сценам, стилям и экспорту.</p>
    <a href="#" data-product="sketchup" class="btn-outline inline-flex items-center justify-center">Смотреть</a>
  </article>

  <article class="card card--compact" data-cats="coaching">
    <h3 class="card-title">Коучинг</h3>
    <p class="card-text">Индивидуальная работа: портфолио, процессы студии, ценообразование.</p>
    <a href="#" data-product="coaching" class="btn-outline inline-flex items-center justify-center">Смотреть</a>
  </article>

</div>

      <!-- ===== Шаблоны контента для просмотра товара ===== -->
      <template id="tpl-contracts">
        <h2 class="text-2xl md:text-3xl font-bold mb-2 text-center">Договоры и шаблоны</h2>
        <p class="text-slate-700 mb-4">Комплект документов для фриланса и студий: договоры, акты, спецификации, чек‑листы внедрения. Подходит новичкам и практикующим.</p>
        <ul class="list-disc pl-5 text-slate-700 space-y-1 mb-5">
          <li>Договор оказания услуг (2 варианта: фриланс / студия)</li>
          <li>Акты сдачи‑приёмки, ТЗ, спецификация</li>
          <li>Чек‑листы согласования этапов и контроля</li>
          <li>Форматы: DOCX + PDF, можно редактировать</li>
        </ul>
        <div class="flex flex-wrap items-end gap-4">
          <div>
            <div class="text-sm uppercase tracking-wide text-slate-500">Цена</div>
            <div class="text-3xl font-bold">2 900 ₽</div>
          </div>
          <a href="checkout.html?product=contracts" class="btn-primary inline-flex items-center px-5 py-3 rounded-lg font-semibold shadow"><i class="fa-solid fa-cart-shopping mr-2"></i>Купить комплект</a>
          <a href="legal.html" class="inline-flex items-center px-4 py-2 rounded-lg border border-emerald-600 text-emerald-700 hover:bg-emerald-50">Подробнее о правовом модуле</a>
        </div>
      </template>

      <template id="tpl-coaching">
        <h2 class="text-2xl md:text-3xl font-bold mb-2 text-center">Коучинг дизайнеров</h2>
        <p class="text-slate-700 mb-4">Индивидуальная работа: портфолио, офферы, процессы студии, ценообразование и переговоры.</p>
        <ul class="list-disc pl-5 text-slate-700 space-y-1 mb-5">
          <li>Разбор позиции и портфолио</li>
          <li>Маршрутная карта процессов и шаблоны</li>
          <li>Сценарии переговоров и цены</li>
        </ul>
        <div class="flex flex-wrap items-end gap-4">
          <div>
            <div class="text-sm uppercase tracking-wide text-slate-500">Форматы</div>
            <div class="text-sm">1×50 мин — <span class="font-semibold">3 900 ₽</span><br>3×50 мин — <span class="font-semibold">9 900 ₽</span></div>
          </div>
          <a href="checkout.html?product=coaching-1" class="btn-primary inline-flex items-center px-5 py-3 rounded-lg font-semibold shadow"><i class="fa-solid fa-cart-shopping mr-2"></i>Купить 1 сессию</a>
          <a href="checkout.html?product=coaching-3" class="inline-flex items-center px-5 py-3 rounded-lg font-semibold border border-emerald-600 text-emerald-700 hover:bg-emerald-50">Купить 3 сессии</a>
        </div>
        <p class="mt-3 text-xs text-slate-500">После оплаты согласуем удобное время в Telegram.</p>
      </template>

      <template id="tpl-3dsmax">
        <h2 class="text-2xl md:text-3xl font-bold mb-2 text-center">3ds Max — мини‑модули</h2>
        <p class="text-slate-700 mb-4">Сфокусированные занятия по освещению, материалам, камерам и ускорению рендера.</p>
        <ul class="list-disc pl-5 text-slate-700 space-y-1 mb-5">
          <li>Свет и экспозиция: быстрые приёмы</li>
          <li>Материалы: дерево, металл, ткань</li>
          <li>Рендер без шума: чек‑лист настроек</li>
        </ul>
        <div class="flex flex-wrap items-end gap-4">
          <div>
            <div class="text-sm uppercase tracking-wide text-slate-500">Цена за модуль</div>
            <div class="text-3xl font-bold">1 200 ₽</div>
          </div>
          <a href="checkout.html?product=3dsmax-module" class="btn-primary inline-flex items-center px-5 py-3 rounded-lg font-semibold shadow"><i class="fa-solid fa-cart-shopping mr-2"></i>Купить модуль</a>
          <a href="3dsmax.html" class="inline-flex items-center px-4 py-2 rounded-lg border border-emerald-600 text-emerald-700 hover:bg-emerald-50">Страница программы</a>
        </div>
      </template>

      <template id="tpl-sketchup">
        <h2 class="text-2xl md:text-3xl font-bold mb-2 text-center">SketchUp — инструменты и библиотеки</h2>
        <p class="text-slate-700 mb-4 text-center">Три быстрых способа ускорить работу: текстуры, модели и проверенные плагины.</p>

        <div class="flex flex-col gap-6">

          <!-- 1. Библиотека текстур -->
          <div class="card border border-gray-200 rounded-xl bg-white p-4">
            <div class="flex items-center justify-between mb-1">
              <h3 class="text-lg font-semibold">Библиотека текстур</h3>
              <span class="inline-flex items-center text-xs px-2 py-0.5 rounded-full bg-emerald-100 text-emerald-700 font-bold">Подписка</span>
            </div>
            <p class="text-slate-700 text-sm">Наша библиотека качественных бесшовных текстур экономит часы поиска. Пополняется каждый месяц.</p>
            <ul class="list-disc pl-5 text-slate-700 text-sm space-y-1 mt-2">
              <li>Проверенные PBR/бесшовные карты</li>
              <li>Категории для интерьеров</li>
              <li>Ежемесячные обновления</li>
            </ul>
            <div class="mt-3 flex items-end justify-between">
              <div>
                <div class="text-xs uppercase tracking-wide text-slate-500">Вход</div>
                <div class="text-xl font-bold">5 000 ₽</div>
              </div>
              <!-- Ссылку предоставите позже -->
              <a href="#" aria-disabled="true" title="Ссылка будет добавлена" class="btn-primary inline-flex items-center px-4 py-2 rounded-lg font-semibold opacity-70 cursor-not-allowed">
                <i class="fa-solid fa-lock mr-2"></i>Оформить подписку
              </a>
            </div>
          </div>

          <!-- 2. Библиотека моделей -->
          <div class="card border border-gray-200 rounded-xl bg-white p-4">
            <div class="flex items-center justify-between mb-1">
              <h3 class="text-lg font-semibold">Библиотека моделей</h3>
              <span class="inline-flex items-center text-xs px-2 py-0.5 rounded-full bg-sky-100 text-sky-700 font-bold">Бесплатно</span>
            </div>
            <p class="text-slate-700 text-sm">Подборка готовых моделей для SketchUp. Открытый доступ в Telegram.</p>
            <ul class="list-disc pl-5 text-slate-700 text-sm space-y-1 mt-2">
              <li>Актуальные подборки</li>
              <li>Советы по импорту и чистке</li>
            </ul>
            <div class="mt-3 flex items-end justify-between">
              <div>
                <div class="text-xs uppercase tracking-wide text-slate-500">Стоимость</div>
                <div class="text-xl font-bold">0 ₽</div>
              </div>
              <a href="https://t.me/sketchUptwins" target="_blank" rel="noopener" class="inline-flex items-center px-4 py-2 rounded-lg border border-emerald-600 text-emerald-700 hover:bg-emerald-50">
                <i class="fa-brands fa-telegram mr-2"></i>Перейти в TG
              </a>
            </div>
          </div>

          <!-- 3. Плагины для SketchUp -->
          <div class="card border border-gray-200 rounded-xl bg-white p-4">
            <div class="flex items-center justify-between mb-1">
              <h3 class="text-lg font-semibold">Плагины для SketchUp</h3>
              <span class="inline-flex items-center text-xs px-2 py-0.5 rounded-full bg-amber-100 text-amber-700 font-bold">Набор</span>
            </div>
            <p class="text-slate-700 text-sm">Все нужные плагины с понятными инструкциями — подключите и ускорьте рутину.</p>
            <ul class="list-disc pl-5 text-slate-700 text-sm space-y-1 mt-2">
              <li>Подробные гайды по установке</li>
              <li>Рекомендованные настройки</li>
              <li>Быстрый старт для новичков</li>
            </ul>
            <div class="mt-3 flex items-end justify-between">
              <div>
                <div class="text-xs uppercase tracking-wide text-slate-500">Цена</div>
                <div class="text-xl font-bold">990 ₽</div>
              </div>
              <a href="https://t.me/+ktT_ynd8NsUxNjFi" target="_blank" rel="noopener" class="btn-primary inline-flex items-center px-4 py-2 rounded-lg font-semibold">
                <i class="fa-brands fa-telegram mr-2"></i>Получить доступ
              </a>
            </div>
          </div>

        </div>

        <!-- Кнопки навигации -->
        <div class="mt-5 flex flex-wrap items-center justify-center gap-3">
          <a href="#" data-back class="inline-flex items-center px-4 py-2 rounded-lg border border-emerald-600 text-emerald-700 hover:bg-emerald-50"><i class="fa-solid fa-arrow-left mr-2"></i>К списку разделов</a>
          <a href="sketchup.html" class="inline-flex items-center px-4 py-2 rounded-lg border border-gray-300 hover:bg-gray-50"><i class="fa-solid fa-book-open mr-2"></i>Страница программы</a>
        </div>
      </template>

      <!-- Общая кнопка -->
      <div class="mt-10 flex justify-center">
        <a href="#shop-grid" class="btn-primary inline-flex items-center px-6 py-3 rounded-lg font-semibold shadow">
          <i class="fa-solid fa-store mr-2"></i>Показать всё
        </a>
      </div>
    </div>
  </section>

  <div id="site-footer"></div>

  <script>
    (function(){
      var chips = Array.prototype.slice.call(document.querySelectorAll('#shop-filters .chip'));
      var cards = Array.prototype.slice.call(document.querySelectorAll('#shop-grid .card'));
      var pv   = document.getElementById('product-view');
      var grid = document.getElementById('shop-grid');

      function setActive(btn){
        chips.forEach(function(b){ b.classList.remove('is-active'); b.setAttribute('aria-pressed','false'); });
        if(btn){ btn.classList.add('is-active'); btn.setAttribute('aria-pressed','true'); }
      }
      function parseCats(card){
        var raw = card.getAttribute('data-cats') || '';
        return raw.split(',').map(function(s){ return s.trim(); }).filter(Boolean);
      }
      function applyFilter(key){
        cards.forEach(function(card){
          if(key === '*'){ card.classList.remove('is-hidden'); return; }
          var cats = parseCats(card);
          var match = cats.indexOf(key) !== -1;
          card.classList.toggle('is-hidden', !match);
        });
      }
      function getParam(name){
        var params = new URLSearchParams(window.location.search);
        return params.get(name);
      }
      function initFromQuery(){
        var cat = getParam('cat');
        if(!cat){ applyFilter('*'); return; }
        var btn = chips.find(function(c){ return c.getAttribute('data-filter') === cat; });
        if(btn){ setActive(btn); applyFilter(cat); }
        else { applyFilter('*'); }
      }

      chips.forEach(function(btn){
        btn.addEventListener('click', function(){
          // Если открыт просмотр товара — закрываем и возвращаем сетку
          if(pv && !pv.classList.contains('hidden')){
            pv.classList.add('hidden');
            grid.classList.remove('hidden');
            var url0 = new URL(window.location.href);
            url0.searchParams.delete('item');
            history.replaceState(null, '', url0.toString());
          }

          var key = btn.getAttribute('data-filter');
          setActive(btn);
          applyFilter(key);
          // update ?cat= in URL without reload
          var url = new URL(window.location.href);
          if(key === '*') url.searchParams.delete('cat');
          else url.searchParams.set('cat', key);
          history.replaceState(null, '', url.toString());
        });
      });

      // init on load
      initFromQuery();
    })();
  </script>
  <script>
    (function(){
      const grid = document.getElementById('shop-grid');
      const view = document.getElementById('product-view');
      const content = document.getElementById('product-content');
      const backBtn = document.getElementById('back-to-shop');
      const partials = {
        'legal': 'shop/legal.html',
        'psychology': 'shop/psychology.html',
        'ai-tools': 'shop/ai-tools.html'
      };

      function tplId(key){ return 'tpl-' + key; }
      function getTpl(key){ return document.getElementById(tplId(key)); }

      async function openProduct(key){
        const tpl = getTpl(key);
        const partial = partials[key];

        // show view first, with a light loading state to avoid layout jumps
        grid.classList.add('hidden');
        view.classList.remove('hidden');

        if (partial) {
          content.innerHTML = '<div class="py-6 text-center text-slate-500">Загружаем…</div>';
          try {
            const res = await fetch(partial, { credentials: 'same-origin' });
            if (!res.ok) throw new Error('HTTP ' + res.status);
            const html = await res.text();
            content.innerHTML = html;
          } catch (err) {
            console.error('[shop] failed to load partial', partial, err);
            content.innerHTML = '<p class="text-red-600">Не удалось загрузить раздел. Обновите страницу или попробуйте позже.</p>';
          }
        } else {
          if (!tpl) {
            content.innerHTML = '<p class="text-slate-700">Контент в разработке. Выберите другой раздел.</p>';
          } else {
            content.innerHTML = tpl.innerHTML;
          }
        }

        // update URL (?item=)
        const url = new URL(window.location.href);
        url.searchParams.set('item', key);
        history.replaceState(null, '', url.toString());

        // scroll into view
        view.scrollIntoView({behavior:'smooth', block:'start'});
      }

      function closeProduct(){
        view.classList.add('hidden');
        grid.classList.remove('hidden');
        const url = new URL(window.location.href);
        url.searchParams.delete('item');
        history.replaceState(null, '', url.toString());
      }

      document.querySelectorAll('#shop-grid a[data-product]').forEach(function(link){
        link.addEventListener('click', async function(e){
          e.preventDefault();
          const product = link.getAttribute('data-product');
          await openProduct(product);
        });
      });

      backBtn.addEventListener('click', closeProduct);

      // Delegate back action for buttons inside loaded partials
      content.addEventListener('click', function(e){
        const back = e.target.closest('[data-back]');
        if(back){
          e.preventDefault();
          closeProduct();
        }
      });

      // Закрытие по Esc
      document.addEventListener('keydown', function(e){
        if(e.key === 'Escape' && !view.classList.contains('hidden')) closeProduct();
      });

      // Открытие по параметру ?item=
      (async function initFromQuery(){
        const params = new URLSearchParams(window.location.search);
        const key = params.get('item');
        if (key) await openProduct(key);
      })();
    })();
  </script>

  <script src="app.js" defer></script>
</body>
</html>